<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{fragments :: head-content(title=${post.title})}">
    <title>Blog Post Details</title>
</head>

<body>
<header th:replace="~{fragments :: header}"></header>

<main>
    <div style="margin-bottom: 2rem;">
        <a href="/blog" style="text-decoration: none; color: var(--text-muted); font-size: 0.9rem;">&larr; Back to
            Blog</a>
    </div>

    <article>
        <h1 th:text="${post.title}">Post Title</h1>

        <p class="post-date">
            Published on <span th:text="${#temporals.format(post.createdAt, 'dd MMM, yyyy')}">Date</span>
            &bull;
            <span th:text="${post.readingTime}">2 min read</span>
        </p>

        <hr>

        <div th:utext="${htmlContent}">
            <p>Content loading...</p>
        </div>

        <div class="share-section">
            <button onclick="copyLink()" class="copy-btn" id="shareBtn" title="Copy article URL">
                <span id="btnIcon">ðŸ”—</span>
                <span id="btnText">Copy Link</span>
            </button>
        </div>

        <div th:if="${!post.tags.empty}" style="margin-top: 1.5rem; padding-top: 10px;">
            <strong>Tags: </strong>
            <span th:each="tag : ${post.tags}" style="margin-right: 10px;">
                    <a th:href="@{'/tag/' + ${tag.name}}" style="text-decoration: none; color: var(--link-color);">
                        #<span th:text="${tag.name}">java</span>
                    </a>
                </span>
        </div>
    </article>
</main>

<footer th:replace="~{fragments :: footer}"></footer>

<script>
    function copyLink() {
        // 1. Copy URL to clipboard
        navigator.clipboard.writeText(globalThis.location.href).then(() => {

            // 2. Visual Feedback
            const btnText = document.getElementById('btnText');
            const btnIcon = document.getElementById('btnIcon');

            const originalText = btnText.innerText;
            const originalIcon = btnIcon.innerText;

            btnText.innerText = 'Copied!';
            btnIcon.innerText = 'âœ…';

            // 3. Reset after 2 seconds
            setTimeout(() => {
                btnText.innerText = originalText;
                btnIcon.innerText = originalIcon;
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy: ', err);
        });
    }
</script>

</body>
</html>